<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Picture Enhancer | EREX-TECHNOLOGIES</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
  background:#0d1b2a;
  font-family:Arial,sans-serif;
  height:100vh;
  overflow:hidden;
  display:flex;
  justify-content:center;
  align-items:center;
  color:#fff;
}

.app{
  width:100%;
  max-width:420px;
  height:100vh;
  background:#000;
  display:flex;
  flex-direction:column;
}

/* Camera preview */
.preview{
  flex:1;
  position:relative;
  overflow:hidden;
}

video{
  width:100%;
  height:100%;
  object-fit:cover;
}

.aspect-frame{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  border:2px dashed rgba(255,255,255,0.6);
  pointer-events:none;
}

/* Top bar */
.top-bar{
  position:absolute;
  top:10px;
  left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,0.5);
  padding:6px 12px;
  border-radius:20px;
  display:flex;
  gap:10px;
}

.top-bar select{
  background:#1b263b;
  color:#fff;
  border:none;
  padding:4px 6px;
  border-radius:6px;
}

/* Bottom controls */
.controls{
  background:#0d1b2a;
  padding:10px;
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;
}

.control{
  display:flex;
  flex-direction:column;
  font-size:0.7rem;
}

.control input{
  width:100%;
}

.actions{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-top:8px;
}

button{
  background:#00b4d8;
  border:none;
  color:#fff;
  padding:12px;
  border-radius:50%;
  font-size:1rem;
  cursor:pointer;
}

.snap{
  width:70px;
  height:70px;
  font-size:1.4rem;
}
</style>
</head>
<body>

<div class="app">
  <div class="preview">
    <video id="video" autoplay playsinline></video>
    <div class="aspect-frame" id="frame"></div>

    <div class="top-bar">
      <select id="aspect">
        <optgroup label="Portrait">
          <option value="3/4">3:4</option>
          <option value="9/16">9:16</option>
        </optgroup>
        <optgroup label="Landscape">
          <option value="4/3">4:3</option>
          <option value="16/9" selected>16:9</option>
        </optgroup>
        <optgroup label="Square">
          <option value="1">1:1</option>
        </optgroup>
      </select>
    </div>
  </div>

  <div class="controls">
    <div class="control">Zoom<input type="range" id="zoom" min="1" max="3" step="0.01" value="1"></div>
    <div class="control">Brightness<input type="range" id="brightness" min="50" max="150" value="100"></div>
    <div class="control">Contrast<input type="range" id="contrast" min="50" max="150" value="100"></div>
    <div class="control">Saturation<input type="range" id="saturation" min="0" max="200" value="100"></div>
  </div>

  <div class="controls actions">
    <button id="toggle">ðŸ”„</button>
    <button class="snap" id="snap">ðŸ“¸</button>
    <div></div>
  </div>
</div>

<canvas id="canvas" style="display:none"></canvas>

<script>
const video=document.getElementById('video');
const canvas=document.getElementById('canvas');
const frame=document.getElementById('frame');
const zoom=document.getElementById('zoom');
const brightness=document.getElementById('brightness');
const contrast=document.getElementById('contrast');
const saturation=document.getElementById('saturation');
const aspect=document.getElementById('aspect');
const snap=document.getElementById('snap');
const toggle=document.getElementById('toggle');

let stream; let front=true;

async function startCamera(){
  if(stream) stream.getTracks().forEach(t=>t.stop());
  stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:front?'user':'environment'}});
  video.srcObject=stream;
}

function updateFilters(){
  video.style.filter=`brightness(${brightness.value}%) contrast(${contrast.value}%) saturate(${saturation.value}%)`;
  video.style.transform=`scale(${zoom.value})`;
}

[zoom,brightness,contrast,saturation].forEach(i=>i.oninput=updateFilters);

toggle.onclick=()=>{front=!front;startCamera();};

function updateFrame(){
  const r=eval(aspect.value);
  const box=video.getBoundingClientRect();
  let w,h;
  if(box.width/box.height>r){h=box.height*0.85;w=h*r;}else{w=box.width*0.85;h=w/r;}
  frame.style.width=w+'px';frame.style.height=h+'px';
}

aspect.onchange=updateFrame;
window.onresize=updateFrame;

snap.onclick=()=>{
  const r=eval(aspect.value);
  const vw=video.videoWidth;
  const vh=video.videoHeight;
  canvas.width=vw;
  canvas.height=vw/r;
  const ctx=canvas.getContext('2d');
  ctx.filter=video.style.filter;
  let sx=0,sy=0,sw=vw,sh=vh;
  if(vw/vh>r){sw=vh*r;sx=(vw-sw)/2;}else{sh=vw/r;sy=(vh-sh)/2;}
  ctx.drawImage(video,sx,sy,sw,sh,0,0,canvas.width,canvas.height);
  const a=document.createElement('a');
  a.href=canvas.toDataURL('image/png');
  a.download='photo.png';
  a.click();
};

startCamera();updateFrame();
</script>
</body>
</html>
